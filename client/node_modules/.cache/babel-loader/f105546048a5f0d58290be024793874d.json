{"ast":null,"code":"import _regeneratorRuntime from\"/home/frboy/whyshop/cliend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/frboy/whyshop/cliend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';var baseURL='http://localhost:4000/';export var ImagePath=function ImagePath(imageId){return\"\".concat(baseURL,\"images/\").concat(imageId,\".jpg\");};var instance=axios.create({baseURL:'http://localhost:4000/api/',headers:{'authorization':localStorage.getItem('accesstoken')},withCredentials:true});instance.interceptors.response.use(function(response){return response;},/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(error){var _yield$instance$put,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(error.response.status===401)){_context.next=15;break;}_context.prev=1;localStorage.removeItem('accesstoken');_context.next=5;return instance.put('/auth/refreshtoken',{withCredentials:true});case 5:_yield$instance$put=_context.sent;data=_yield$instance$put.data;localStorage.setItem('accesstoken',data.accesstoken);window.location.reload('/');_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);localStorage.removeItem('accesstoken');return _context.abrupt(\"return\",Promise.reject(error));case 15:return _context.abrupt(\"return\",Promise.reject(error));case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function(_x){return _ref.apply(this,arguments);};}());export default instance;","map":{"version":3,"sources":["/home/frboy/whyshop/cliend/src/Axios.js"],"names":["axios","baseURL","ImagePath","imageId","instance","create","headers","localStorage","getItem","withCredentials","interceptors","response","use","error","status","removeItem","put","data","setItem","accesstoken","window","location","reload","Promise","reject"],"mappings":"+RAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAGA,GAAMC,CAAAA,OAAO,CAAG,wBAAhB,CAEA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,OAAD,kBAAgBF,OAAhB,mBAAiCE,OAAjC,UAAlB,CAEP,GAAMC,CAAAA,QAAQ,CAAGJ,KAAK,CAACK,MAAN,CAAa,CAC1BJ,OAAO,CAAE,4BADiB,CAE1BK,OAAO,CAAE,CACL,gBAAiBC,YAAY,CAACC,OAAb,CAAqB,aAArB,CADZ,CAFiB,CAK1BC,eAAe,CAAE,IALS,CAAb,CAAjB,CAQAL,QAAQ,CAACM,YAAT,CAAsBC,QAAtB,CAA+BC,GAA/B,CACI,SAAAD,QAAQ,QAAIA,CAAAA,QAAJ,EADZ,0FAEI,iBAAME,KAAN,oJACQA,KAAK,CAACF,QAAN,CAAeG,MAAf,GAA0B,GADlC,2CAGYP,YAAY,CAACQ,UAAb,CAAwB,aAAxB,EAHZ,sBAImCX,CAAAA,QAAQ,CAACY,GAAT,CAAa,oBAAb,CAAmC,CAAEP,eAAe,CAAE,IAAnB,CAAnC,CAJnC,0CAIoBQ,IAJpB,qBAIoBA,IAJpB,CAKYV,YAAY,CAACW,OAAb,CAAqB,aAArB,CAAoCD,IAAI,CAACE,WAAzC,EACAC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,GAAvB,EANZ,iFAQYf,YAAY,CAACQ,UAAb,CAAwB,aAAxB,EARZ,gCASmBQ,OAAO,CAACC,MAAR,CAAeX,KAAf,CATnB,0CAYWU,OAAO,CAACC,MAAR,CAAeX,KAAf,CAZX,uEAFJ,gEAoBA,cAAeT,CAAAA,QAAf","sourcesContent":["import axios from 'axios';\n\n\nconst baseURL = 'http://localhost:4000/';\n\nexport const ImagePath = (imageId) => `${baseURL}images/${imageId}.jpg`;\n\nconst instance = axios.create({\n    baseURL: 'http://localhost:4000/api/',\n    headers: {\n        'authorization': localStorage.getItem('accesstoken'),\n    },\n    withCredentials: true\n   \n});\ninstance.interceptors.response.use(\n    response => response,\n    async error => {\n        if (error.response.status === 401) {\n            try {\n                localStorage.removeItem('accesstoken')\n                const { data } = await instance.put('/auth/refreshtoken', { withCredentials: true })\n                localStorage.setItem('accesstoken', data.accesstoken)\n                window.location.reload('/')\n            } catch (_error) {\n                localStorage.removeItem('accesstoken');\n                return Promise.reject(error)\n            }\n        }\n        return Promise.reject(error);\n    }\n);\n\n\n\nexport default instance"]},"metadata":{},"sourceType":"module"}