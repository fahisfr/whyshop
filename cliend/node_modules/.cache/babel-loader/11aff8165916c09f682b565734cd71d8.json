{"ast":null,"code":"import _regeneratorRuntime from\"/home/frboy/whyshop/cliend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/frboy/whyshop/cliend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{useDispatch}from'react-redux';import{login}from'./Features/User';var baseURL='http://localhost:4000/';export var ImagePath=function ImagePath(imageId){return\"\".concat(baseURL,\"images/\").concat(imageId,\".jpg\");};var instance=axios.create({baseURL:'http://localhost:4000/api/',headers:{'authorization':localStorage.getItem('accesstoken')}});instance.interceptors.response.use(function(response){return response;},/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(error){var dispatch,_yield$instance$put,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(error.response.status===401&&error.response.data.message==='token expired')){_context.next=14;break;}_context.prev=1;dispatch=useDispatch();_context.next=5;return instance.put('/auth/refreshtoken',{withCredentials:true});case 5:_yield$instance$put=_context.sent;data=_yield$instance$put.data;localStorage.setItem('accesstoken',data.accesstoken);dispatch(login({name:data.name,roel:data.roel,number:data.number,isAthu:true}));_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);return _context.abrupt(\"return\",Promise.reject(error));case 14:return _context.abrupt(\"return\",Promise.reject(error));case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function(_x){return _ref.apply(this,arguments);};}());export default instance;","map":{"version":3,"sources":["/home/frboy/whyshop/cliend/src/Axios.js"],"names":["axios","useDispatch","login","baseURL","ImagePath","imageId","instance","create","headers","localStorage","getItem","interceptors","response","use","error","status","data","message","dispatch","put","withCredentials","setItem","accesstoken","name","roel","number","isAthu","Promise","reject"],"mappings":"+RAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,KAAT,KAAsB,iBAAtB,CAEA,GAAMC,CAAAA,OAAO,CAAG,wBAAhB,CAEA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,OAAD,kBAAgBF,OAAhB,mBAAiCE,OAAjC,UAAlB,CAEP,GAAMC,CAAAA,QAAQ,CAAGN,KAAK,CAACO,MAAN,CAAa,CAC1BJ,OAAO,CAAE,4BADiB,CAE1BK,OAAO,CAAE,CACL,gBAAiBC,YAAY,CAACC,OAAb,CAAqB,aAArB,CADZ,CAFiB,CAAb,CAAjB,CAOAJ,QAAQ,CAACK,YAAT,CAAsBC,QAAtB,CAA+BC,GAA/B,CACI,SAAAD,QAAQ,QAAIA,CAAAA,QAAJ,EADZ,0FAEI,iBAAME,KAAN,6JACQA,KAAK,CAACF,QAAN,CAAeG,MAAf,GAA0B,GAA1B,EAAiCD,KAAK,CAACF,QAAN,CAAeI,IAAf,CAAoBC,OAApB,GAAgC,eADzE,2CAGkBC,QAHlB,CAG6BjB,WAAW,EAHxC,uBAImCK,CAAAA,QAAQ,CAACa,GAAT,CAAa,oBAAb,CAAmC,CAAEC,eAAe,CAAE,IAAnB,CAAnC,CAJnC,0CAIoBJ,IAJpB,qBAIoBA,IAJpB,CAKYP,YAAY,CAACY,OAAb,CAAqB,aAArB,CAAoCL,IAAI,CAACM,WAAzC,EACAJ,QAAQ,CAAChB,KAAK,CAAC,CAAEqB,IAAI,CAAEP,IAAI,CAACO,IAAb,CAAmBC,IAAI,CAAER,IAAI,CAACQ,IAA9B,CAAoCC,MAAM,CAAET,IAAI,CAACS,MAAjD,CAAyDC,MAAM,CAAE,IAAjE,CAAD,CAAN,CAAR,CANZ,iHAQmBC,OAAO,CAACC,MAAR,CAAed,KAAf,CARnB,0CAWWa,OAAO,CAACC,MAAR,CAAed,KAAf,CAXX,uEAFJ,gEAmBA,cAAeR,CAAAA,QAAf","sourcesContent":["import axios from 'axios';\nimport { useDispatch } from 'react-redux'\nimport { login } from './Features/User'\n\nconst baseURL = 'http://localhost:4000/';\n\nexport const ImagePath = (imageId) => `${baseURL}images/${imageId}.jpg`;\n\nconst instance = axios.create({\n    baseURL: 'http://localhost:4000/api/',\n    headers: {\n        'authorization': localStorage.getItem('accesstoken'),\n    }\n   \n});\ninstance.interceptors.response.use(\n    response => response,\n    async error => {\n        if (error.response.status === 401 && error.response.data.message === 'token expired') {\n            try {\n                const dispatch = useDispatch()\n                const { data } = await instance.put('/auth/refreshtoken', { withCredentials: true})\n                localStorage.setItem('accesstoken', data.accesstoken);\n                dispatch(login({ name: data.name, roel: data.roel, number: data.number, isAthu: true }))\n            } catch (_error) {\n                return Promise.reject(error)\n            }\n        }\n        return Promise.reject(error);\n    }\n);\n\n\n\nexport default instance"]},"metadata":{},"sourceType":"module"}